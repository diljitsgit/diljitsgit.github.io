---
import fs from "fs";
import path from "path";
import Footer from "../../components/Footer.tsx";
import Navbar from "../../components/Navbar.tsx";
import PostLayout from "../../layouts/PostLayout.astro";
import "../../styles/global.css";

// Required by Astro dynamic routing
export async function getStaticPaths() {
    const blogDir = path.resolve("./src/content/blog");
    const files = fs.readdirSync(blogDir).filter((f) => f.endsWith(".mdx"));
    return files.map((file) => ({
        params: { slug: file.replace(/\.mdx$/, "") },
    }));
}

const { slug } = Astro.params;
const post = await import(`../../content/blog/${slug}.mdx`);
const frontmatter = post.frontmatter;
---

<Navbar />
<PostLayout title={frontmatter.title} date={frontmatter.date}>
    <post.default />
</PostLayout>
<Footer />
